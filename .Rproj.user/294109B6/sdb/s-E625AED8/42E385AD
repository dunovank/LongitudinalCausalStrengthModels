{
    "collab_server" : "",
    "contents" : "###########################################\n########## Rescorla-Wagner model ##########\n###########################################\n\n#### Calculates associative strength for different causes\n# alpha = learning rate, default of .1\n# df = data frame of cause(s) and effect (causes should include background cue)\n# effectCol = column number of effect\n\nRW <- function(alpha=0.1, df, effectCol) {\n    e <- df[,effectCol] # extracts effect\n    c <- df[,-effectCol] # extracts cause(s)\n    i <- dim(c)[1] # num of observations\n    j <- dim(c)[2] # num of causes\n    \n    # set up vectors for computing V\n    vectors <- matrix(nrow=2, ncol=j) # names of all columns\n    for (k in 1:j) {\n        vectors[1,k] <- paste(\"V\", colnames(c)[k], sep=\"\") # V columns\n        vectors[2,k] <- paste(\"dV\", colnames(c)[k], sep=\"\") # deltaV columns\n    }\n    \n    # create vectors\n    V <- matrix(0, nrow=i+1, ncol=j) # V vectors for all causes\n    colnames(V) <- vectors[1,] # name the columns\n    dV <- matrix(0, nrow=i+1, ncol=j) # dV vectors for all causes\n    colnames(dV) <- vectors[2,] # name the columns\n    VTotal <- numeric(i+1) # vector for total V\n    error <- numeric(i+1) # vector for error\n    \n    # compute associative strength\n    for (p in 1:i) {\n        VTotal[p] <- sum(c[p,]*V[p,]) # calculate VTotal\n        error[p] <- e[p]-VTotal[p] # calculate prediction error\n        dV[p,] <- as.numeric(alpha*c[p,]*error[p]) # calculate change in V for each cause\n        V[p+1,] <- as.numeric(V[p,]+dV[p,]) # update next trial's associative strength\n    }\n    \n    # return associative strengths in data frame WITH original data frame\n    df[i+1,] <- NA\n    t <- c(1:(i+1))\n    return(data.frame(t, df, V, VTotal, error, dV))\n}\n",
    "created" : 1463666022064.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3195397500",
    "id" : "42E385AD",
    "lastKnownWriteTime" : 1463667313,
    "last_content_update" : 1463667313316,
    "path" : "~/Box Sync/Projects/LearningCausalStrength/RCode/RescorlaWagner/RW_model.R",
    "project_path" : "RW_model.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}